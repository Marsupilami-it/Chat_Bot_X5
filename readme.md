# Запуск

1) Клонируйте репозиторий проекта:

``` bash
git clone -b api https://github.com/Marsupilami-it/Chat_Bot_X5.git
```

2. Перейдите в директорию проекта:

``` bash
cd Chat_Bot_X5
```

3. Выполните команду ls и убедитесь, что вывод соответствует:
```
Dockerfile.api          docker-compose.yml      requirements.txt
Dockerfile.ui           outter_api.py           ui.py
```

4. Постройте и запустите контейнеры с помощью Docker Compose:
``` bash
docker-compose up --build -d
```
5. Проверьте статус запущенных контейнеров:

``` bash
docker-compose ps
```

6. Откройте браузер и перейдите по адресу:
```
http://localhost:8501
```

Если вы запускаете приложение на удаленном сервере, замените localhost на IP-адрес вашего сервера.


# Тестирование API
Запустив Docker контейнеры можно обращаться к чат боту двумя способами:
1) через ui интефрейс. Для этого зайти на сайт http://localhost:8501/ либо 51.250.79.164 (хост сервер)
2) прокидывать POST запросы. Для этого откройте postman или любой другой источник в поле адрес укажите
POST http://localhost:8503/api/v1/get_answer/
Тело сообщения может быть в формате истории общения пользователя с чат-ботом. Пример body ниже
``` json 
{
  "history": [
    {
      "role": "user",
      "content": "Добрый день! Хотел бы уточнить, как можно оформить отпуск в следующем месяце?"
    },
    {
      "role": "assistant",
      "content": "Здравствуйте! Для оформления отпуска вам нужно заполнить заявление на отпуск и согласовать даты с руководителем. После этого заявление отправляется в отдел кадров для оформления приказа."
    },
    {
      "role": "user",
      "content": "Спасибо! Есть ли ограничения по продолжительности отпуска?"
    },
    {
      "role": "assistant",
      "content": "Обычно отпуск предоставляется на срок до 28 календарных дней в год. Однако, вы можете разбить его на несколько частей, при этом одна из частей не может быть меньше 14 дней."
    },
    {
      "role": "user",
      "content": "Понял. А можно ли перенести часть отпуска на следующий год?"
    }
  ]
}

```
Вы получите ответ в такой структуре JSON. Берете message и в нем первое значение content
```
{'model': 'gemma2:2b-instruct-q8_0',
 'created_at': '2024-09-12T16:14:14.262655667Z',
 'message': {'role': 'assistant',
  'content': 'Создайте, пожалуйста, обращение в ИТ поддержку на портале support \n'},
 'done_reason': 'stop',
 'done': True,
 'total_duration': 593868968,
 'load_duration': 43207425,
 'prompt_eval_count': 378,
 'prompt_eval_duration': 209776000,
 'eval_count': 18,
 'eval_duration': 338986000}
```
Требования из кейса к API
![Описание изображения](docs/api-instruction.jpg)



Контакты:

Авторы команда DeltaX
По вопросам запуска обращайтесь в ТГ @andrew_eu